<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2017-03-30 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170330" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Play! 2.x &#x2013; Processing web assets</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
<link rel="stylesheet" href="./css/site.css" type="text/css" />
      <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-17472708-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>Play! 2.x</h2>
</div>
</div>
        <div class="pull-right"><div id="bannerRight"><img src="images/my-avatar-80.png"  alt="avatar"/></div>
</div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2017-03-30<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0.0-beta7-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a>  </li>
    <li><a href="play2-maven-plugin/plugin-info.html" title="Plugin goals"><span class="none"></span>Plugin goals</a>  </li>
          <li class="nav-header">Usage</li>
    <li><a href="usage.html" title="General instructions"><span class="none"></span>General instructions</a>  </li>
    <li><a href="usage-play26.html" title="Play 2.6.x"><span class="none"></span>Play 2.6.x</a>  </li>
    <li><a href="usage-play25.html" title="Play 2.5.x"><span class="none"></span>Play 2.5.x</a>  </li>
    <li><a href="usage-play24.html" title="Play 2.4.x"><span class="none"></span>Play 2.4.x</a>  </li>
    <li><a href="usage-play23.html" title="Play 2.3.x"><span class="none"></span>Play 2.3.x</a>  </li>
    <li><a href="usage-play22.html" title="Play 2.2.x"><span class="none"></span>Play 2.2.x</a>  </li>
    <li><a href="usage-play21.html" title="Play 2.1.x"><span class="none"></span>Play 2.1.x</a>  </li>
          <li class="nav-header">Migration</li>
    <li><a href="migration-plugin.html" title="From previous plugin version"><span class="none"></span>From previous plugin version</a>  </li>
    <li><a href="migration-play26.html" title="From Play 2.5.x to 2.6.x"><span class="none"></span>From Play 2.5.x to 2.6.x</a>  </li>
    <li><a href="migration-play25.html" title="From Play 2.4.x to 2.5.x"><span class="none"></span>From Play 2.4.x to 2.5.x</a>  </li>
    <li><a href="migration-play24.html" title="From Play 2.3.x to 2.4.x"><span class="none"></span>From Play 2.3.x to 2.4.x</a>  </li>
    <li><a href="migration-play23.html" title="From Play 2.2.x to 2.3.x"><span class="none"></span>From Play 2.2.x to 2.3.x</a>  </li>
    <li><a href="migration-play22.html" title="From Play 2.1.x to 2.2.x"><span class="none"></span>From Play 2.1.x to 2.2.x</a>  </li>
          <li class="nav-header">IDE integration</li>
    <li><a href="ide-integration-eclipse.html" title="Eclipse/ScalaIDE"><span class="none"></span>Eclipse/ScalaIDE</a>  </li>
    <li><a href="ide-integration-idea.html" title="IntelliJ IDEA"><span class="none"></span>IntelliJ IDEA</a>  </li>
          <li class="nav-header">Other topics</li>
    <li class="active"><a href="#"><span class="none"></span>Assets processing</a>
  </li>
    <li><a href="running.html" title="Running in development mode"><span class="none"></span>Running in development mode</a>  </li>
    <li><a href="multi-module-builds.html" title="Multi-module builds"><span class="none"></span>Multi-module builds</a>  </li>
    <li><a href="war-packaging.html" title="WAR packaging"><span class="none"></span>WAR packaging</a>  </li>
            <li class="nav-header">Modules</li>
    <li><a href="play2-maven-plugin/index.html" title="Play! 2.x Maven Plugin"><span class="none"></span>Play! 2.x Maven Plugin</a>  </li>
    <li><a href="play2-provider-api/index.html" title="Play! 2.x Provider API"><span class="none"></span>Play! 2.x Provider API</a>  </li>
    <li><a href="play2-providers/index.html" title="Play! 2.x Providers"><span class="none"></span>Play! 2.x Providers</a>  </li>
    <li><a href="play2-source-position-mappers/index.html" title="Play! 2.x Source Position Mappers"><span class="none"></span>Play! 2.x Source Position Mappers</a>  </li>
    <li><a href="play2-source-watcher-api/index.html" title="Play! 2.x Source Watcher API"><span class="none"></span>Play! 2.x Source Watcher API</a>  </li>
    <li><a href="play2-source-watchers/index.html" title="Play! 2.x Source Watchers"><span class="none"></span>Play! 2.x Source Watchers</a>  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span9" >
<div class="section">
<h2><a name="Processing_web_assets"></a>Processing web assets</h2>
<p>Web assets can be static (unmanaged in SBT terminology) or generated during the build (managed). Their location in distribution archive is by convention inside <tt>public</tt> directory although this path can be configured.</p>
<p>Unmanaged assets are files (e.g. images, css and javascript files), by convention located inside <tt>public</tt> directory, which should be copied to distibution archive without any processing.</p>
<p>Managed assets are created during the build process usually by transforming other files (e.g. less, coffeescript). Input files are located by convention inside <tt>app/assets</tt> directory.</p>
<p>There is no one, proper way of processing web assets. Processing is not tightly coupled with building server side of Play! Framework application. They can even be processed by separate build system (e.g. Grunt).</p>
<p>In fact in Play! Framework this changed over time.</p>
<p>In versions 2.0.x to 2.2.x unmanaged assets were treated as resources and were just copied to build output directory. Managed assets were processed by <tt>CoffeescriptCompiler</tt>, <tt>LessCompiler</tt> and <tt>JavascriptCompiler</tt> and generated files were added to build output directory as well.</p>
<p>In Play! Framework 2.3.x things changed. Web assets processing (both unmanaged and managed) was moved to external <a class="externalLink" href="https://github.com/sbt/sbt-web">SbtWeb</a> plugins family.</p>
<p>I Maven build assets should be treated as resources. Below are described some build configurations.</p>
<div class="section">
<h3><a name="Static_assets_only"></a>Static assets only</h3>
<p>The simplest case is a project with static assets only. Configuration is very simple.</p>

<div class="source">
<div class="source"><pre class="prettyprint">    &lt;build&gt;
        ...
        &lt;resources&gt;
            ...
            &lt;resource&gt;
                &lt;directory&gt;${basedir}/public&lt;/directory&gt;
                &lt;targetPath&gt;public&lt;/targetPath&gt;
            &lt;/resource&gt;
        &lt;/resources&gt;
    &lt;/build&gt;
</pre></div></div></div>
<div class="section">
<h3><a name="Processing_of_CoffeeScript_and_Less_files_and_using_Google_Closure_Compiler."></a>Processing of CoffeeScript and Less files and using Google Closure Compiler.</h3>
<p>This plugin contains three simple assets-processing goals: <a href="play2-maven-plugin/coffee-compile-mojo.html">coffee-compile</a>, <a href="play2-maven-plugin/less-compile-mojo.html">less-compile</a> and <a href="play2-maven-plugin/closure-compile-mojo.html">closure-compile</a>.</p>
<p>They implement subset of the features of similar tasks used for assets processing in Play! Framework SBT build before <a class="externalLink" href="https://github.com/sbt/sbt-web">SbtWeb</a> introduction (in version 2.3.x). Check original Play! Framework 2.2.x <a class="externalLink" href="https://www.playframework.com/documentation/2.2.x/Assets#Managed-assets">managed assets documentation</a> for details.</p>
<p>Although these goals have limited functionality, they have some advantages:</p>

<ul>
  
<li>performance (no need to launch external build system),</li>
  
<li>integration with error presentation system when running in development mode.</li>
</ul>
<p>Maven configuration is simple. Add static assets as resources (as in previous scenario) and dynamic assets processing goals:</p>

<div class="source">
<div class="source"><pre class="prettyprint">    &lt;build&gt;
        ...
        &lt;resources&gt;
            ...
            &lt;resource&gt;
                &lt;directory&gt;${basedir}/public&lt;/directory&gt;
                &lt;targetPath&gt;public&lt;/targetPath&gt;
            &lt;/resource&gt;
        &lt;/resources&gt;
        ...
        &lt;plugins&gt;
            ...
            &lt;plugin&gt;
                &lt;groupId&gt;com.google.code.play2-maven-plugin&lt;/groupId&gt;
                &lt;artifactId&gt;play2-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;1.0.0-beta7-SNAPSHOT&lt;/version&gt;
                &lt;extensions&gt;true&lt;/extensions&gt;
                &lt;executions&gt;
                    ...
                    &lt;execution&gt;
                        &lt;id&gt;default-play2-compile-assets&lt;/id&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;closure-compile&lt;/goal&gt; &lt;!-- only if precompiling js assets --&gt;
                            &lt;goal&gt;coffee-compile&lt;/goal&gt; &lt;!-- only if precompiling coffee assets --&gt;
                            &lt;goal&gt;less-compile&lt;/goal&gt; &lt;!-- only if precompiling less assets --&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
            ...
        &lt;/plugins&gt;
        ...
    &lt;/build&gt;
</pre></div></div></div>
<div class="section">
<h3><a name="Using_full_power_of_SbtWeb_build."></a>Using full power of SbtWeb build.</h3>
<p>Check original <a class="externalLink" href="https://github.com/sbt/sbt-web">SbtWeb</a> documentation to learn all its features.</p>
<p>SBTWeb and its plugins <b>cannot</b> be used in Maven build. The workaround is to create auxiliary SBT build for web assets processing purpose only and call it from Maven build using <a class="externalLink" href="https://github.com/sbtrun-maven-plugin/sbtrun-maven-plugin">SBT Runner Maven Plugin</a>.</p>
<p>The simplest configuration is presented below. It may not be clear, why Play! Framework SBT plugin (<tt>&quot;com.typesafe.play&quot; % &quot;sbt-plugin&quot;</tt>) is not used. It&#x2019;s on purpose. SbtWeb plugin has many less dependencies and therefore forked SBT build initialization time is much shorter.</p>
<p>Maven configuration is different. Resource directory must point to the place, where SBTWeb writes all (static and generated) web assets. It&#x2019;s <tt>web/public/main</tt> subdirectory of SBT build output directory. Complete configuration:</p>

<div class="source">
<div class="source"><pre class="prettyprint">    &lt;build&gt;
        ...
        &lt;resources&gt;
            ...
            &lt;resource&gt;
                &lt;directory&gt;${basedir}/target/sbt/web/public/main&lt;/directory&gt;
                &lt;targetPath&gt;public&lt;/targetPath&gt;
            &lt;/resource&gt;
        &lt;/resources&gt;
        ...
        &lt;plugins&gt;
            ...
            &lt;plugin&gt;
                &lt;groupId&gt;com.google.code.sbtrun-maven-plugin&lt;/groupId&gt;
                &lt;artifactId&gt;sbtrun-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;1.0.0-beta4&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;compile-assets&lt;/id&gt;
                        &lt;phase&gt;generate-resources&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;run&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;args&gt;web-assets:assets&lt;/args&gt;
                            &lt;jvmArgs&gt;-Dscala.version=${scala.version}&lt;/jvmArgs&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
            ...
        &lt;/plugins&gt;
        ...
    &lt;/build&gt;
</pre></div></div>
<p>SBT build files:</p>

<ul>
  
<li><tt>build.sbt</tt>:</li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">scalaVersion := Option(System.getProperty(&quot;scala.version&quot;)).getOrElse(&quot;2.11.8&quot;)

lazy val main = (project in file(&quot;.&quot;))
  .enablePlugins(SbtWeb)
  .settings(
    sourceDirectory in Assets := baseDirectory.value / &quot;app/assets&quot;,
    resourceDirectory in Assets := baseDirectory.value / &quot;public&quot;,
    target := baseDirectory.value / &quot;target/sbt&quot;
  )
</pre></div></div>

<ul>
  
<li><tt>project/build.properties</tt>:</li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">sbt.version=0.13.13
</pre></div></div>

<ul>
  
<li><tt>project/plugins.sbt</tt></li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">addSbtPlugin(&quot;com.typesafe.sbt&quot; % &quot;sbt-web&quot; % &quot;1.4.0&quot;)

addSbtPlugin(&quot;com.typesafe.sbt&quot; % &quot;sbt-js-engine&quot; % &quot;1.1.4&quot;)

addSbtPlugin(&quot;com.typesafe.sbt&quot; % &quot;sbt-coffeescript&quot; % &quot;1.0.0&quot;)

addSbtPlugin(&quot;com.typesafe.sbt&quot; % &quot;sbt-less&quot; % &quot;1.1.1&quot;)
</pre></div></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2013&#x2013;2017.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>
